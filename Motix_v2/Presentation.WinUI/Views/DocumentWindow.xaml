<Window
    x:Class="Motix_v2.Presentation.WinUI.Views.DocumentWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:ct="using:CommunityToolkit.WinUI.UI.Controls"
    xmlns:ctp="using:CommunityToolkit.WinUI.UI.Controls.Primitives"
    x:Name="This"
    Title="Buscar Documentos">

    <Grid DataContext="{Binding ViewModel, ElementName=This}">
        <!-- 3 filas: búsqueda, tabla y botón Volver -->
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <!-- Búsqueda -->
            <RowDefinition Height="*"/>
            <!-- DataGrid -->
            <RowDefinition Height="Auto"/>
            <!-- Botones -->
        </Grid.RowDefinitions>

        <!-- Fila 0: Filtros de búsqueda -->
        <!-- Fila 0: Filtros de búsqueda -->
        <Grid Grid.Row="0" Margin="16">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="2*"/>
                <ColumnDefinition Width="2*"/>
                <ColumnDefinition Width="2*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <!-- 1) ID Documento -->
            <TextBox
                PlaceholderText="ID Documento"
                Text="{x:Bind ViewModel.SearchDocumentId, Mode=TwoWay}"
                Grid.Column="0"/>

            <!-- 2) Cliente (picklist) -->
            <ComboBox
                Grid.Column="1"
                Width="200"
                PlaceholderText="Cliente…"
                ItemsSource="{x:Bind ViewModel.ClientNames}"
                SelectedItem="{x:Bind ViewModel.SelectedClientName, Mode=TwoWay}"
                Margin="8,0,0,0"/>

            <!-- 3) EstadoReparto (picklist) -->
            <ComboBox
                Grid.Column="2"
                Width="200"
                PlaceholderText="Estado Reparto…"
                ItemsSource="{x:Bind ViewModel.EstadoRepartoItems}"
                DisplayMemberPath="Value" 
                SelectedItem="{x:Bind ViewModel.SelectedEstadoReparto, Mode=TwoWay}"
                Margin="8,0,0,0"/>

            <!-- 4) Botón Buscar -->
            <Button
      Grid.Column="3"
      Content="Buscar"
      Command="{x:Bind ViewModel.SearchCommand}"
      Margin="8,0,0,0"/>
        </Grid>

        <!-- Fila 1: DataGrid de documentos con ordenado -->
        <ct:DataGrid
            x:Name="DataGridDocuments"
            Grid.Row="1"
            ItemsSource="{x:Bind ViewModel.DocumentItems}"
            AutoGenerateColumns="False"
            IsReadOnly="True"
            CanUserSortColumns="True"
            ColumnWidth="*"
            Margin="16">

            <ct:DataGrid.Columns>
                <ct:DataGridTextColumn
                    Header="ID Documento"
                    Binding="{Binding DocumentoId}" />

                <ct:DataGridTextColumn
                    Header="Cliente"
                    Binding="{Binding Cliente.Nombre}" />

                <ct:DataGridTextColumn
                    Header="Fecha"
                    Binding="{Binding Fecha}" />

                <ct:DataGridTextColumn
                    Header="Total"
                    Binding="{Binding TotalFactura}" >
                    <ct:DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="TextAlignment" Value="Right"/>
                        </Style>
                    </ct:DataGridTextColumn.ElementStyle>
                </ct:DataGridTextColumn>

                <ct:DataGridTextColumn
                    Header="Estado de reparto"
                    Binding="{Binding EstadoReparto}" />
            </ct:DataGrid.Columns>
        </ct:DataGrid>

        <!-- Fila 2: Solo botón Volver -->
        <StackPanel
        Grid.Row="2"
        Orientation="Horizontal"
        HorizontalAlignment="Right"
        Padding="16"
        Spacing="8">
            <Button
          x:Name="ButtonVolver"
          Content="Volver"
          Width="100"
          Click="OnVolverClicked" />
        </StackPanel>
    </Grid>
</Window>
